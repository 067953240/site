{% extends "base.html" %}
{% load static from staticfiles %}
{% block css %}
    <script src="{% static 'simple-comet.js' %}" type="text/javascript"></script>
    <script type="text/javascript">
        $(function () {
            function on_receive(message) {
                var packet = message.split(" ");
                var txt = document.createTextNode(packet);
                txt.innerHTML += "<br/>";
                document.getElementById("test-cases").appendChild(txt)
            }

            SimpleComet.subscribe("{{ SIMPLE_COMET_URL }}channels/sub_{{ submission.id }}.jsonp", function (resp) {
                var messages = resp['messages']['sub_{{ submission.id }}'];
                for (var i = 0; i < messages.length; ++i) {
                    on_receive(messages[i].content);
                }
            });
            SimpleComet.start();
        });
    </script>
{% endblock %}
{% block body %}
    Submitted on {{ submission.time }}
    <br/>
    {% if request.user == submission.user.user %}
        <a href="{% url 'judge.views.problem_submit' submission.problem.code %}">Click here to revise and resubmit!</a>
        <br/>
    {% endif %}
    <b>Test case status</b>
    <br/>
    Status: {{ submission.status }}
    <br/>
    Score: {{ submission.points }} / {{ submission.problem.points }}
    <br/>
    <div id="test-cases"/>
{% endblock %}
